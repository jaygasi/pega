{"version":3,"file":"Aja100_Any_jaygasi_PDFViewer.10e49d5e.js","mappings":"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","sources":["webpack://j251/./src/components/Any_jaygasi_PDFViewer/styles.ts","webpack://j251/./src/components/Any_jaygasi_PDFViewer/diagnostics.tsx","webpack://j251/./src/components/Any_jaygasi_PDFViewer/index.tsx"],"sourcesContent":["import styled, { css } from 'styled-components';\n\n// Main container for the entire component\nexport const PDFViewerContainer = styled.div(() => css`\n  height: 100%;\n  width: 100%;\n  border: 1px solid #d1d5db; /* Softer border color */\n  border-radius: 6px;\n  display: flex;\n  flex-direction: column;\n  background-color: #f9fafb; /* Light background for the whole component */\n  overflow: hidden; /* Prevents content from overflowing rounded corners */\n\n  /* --- Toolbar Styles --- */\n  .rpv-core__toolbar {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    background-color: #ffffff;\n    border-bottom: 1px solid #e5e7eb;\n    padding: 8px 12px;\n    box-sizing: border-box;\n    flex-shrink: 0; /* Prevent toolbar from shrinking */\n  }\n\n  .rpv-core__toolbar-left,\n  .rpv-core__toolbar-middle,\n  .rpv-core__toolbar-right {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 8px; /* Space between items */\n  }\n  \n  .rpv-core__toolbar-middle {\n    flex-grow: 1;\n    justify-content: center;\n  }\n\n  /* --- Modern Button Styles --- */\n  .rpv-core__button {\n    background-color: #ffffff;\n    border: 1px solid #d1d5db;\n    padding: 6px 10px;\n    cursor: pointer;\n    font-size: 18px;\n    color: #374151;\n    border-radius: 6px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: background-color 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;\n    \n    &:hover {\n      background-color: #f9fafb;\n      border-color: #9ca3af;\n    }\n\n    &:focus, &:focus-visible {\n      outline: 2px solid transparent;\n      outline-offset: 2px;\n      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.6);\n      border-color: #6366f1;\n    }\n    \n    &:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n  }\n\n  .rpv-core__current-page-input {\n    padding: 0 8px;\n    font-size: 14px;\n    color: #374151;\n    display: flex;\n    align-items: center;\n    gap: 8px; /* Space between page number items */\n  }\n\n  .rpv-core__search-input {\n    border: 1px solid #d1d5db;\n    border-radius: 6px;\n    padding: 6px 10px;\n    font-size: 14px;\n    min-height: 35px;\n    box-sizing: border-box;\n    transition: border-color 0.2s ease, box-shadow 0.2s ease;\n    \n    &:focus, &:focus-visible {\n      border-color: #6366f1;\n      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.6);\n      outline: none;\n    }\n  }\n\n  /* Search container */\n  .pega-pdf-search-container {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n  }\n`);\n\n// Wraps the actual PDF viewer content area\nexport const ViewerWrapper = styled.div(() => css`\n  height: 100%;\n  width: 100%;\n  overflow: auto;\n  position: relative;\n  flex-grow: 1; /* Allow this to fill remaining space */\n\n  /* Isolate the viewer from the host app's box-sizing model */\n  .rpv-core__viewer, .rpv-core__page-layer, .rpv-core__text-layer {\n    box-sizing: content-box !important;\n  }\n  \n  /* Make the text layer a correctly sized overlay */\n  .rpv-core__text-layer {\n    position: absolute !important;\n    top: 0 !important;\n    left: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    transform-origin: 0 0 !important;\n    color: transparent !important; /* Hide text to prevent ghosting */\n  }\n\n  /* Reset the individual text spans */\n  .rpv-core__text-layer-text {\n    position: absolute !important;\n    white-space: pre !important;\n    line-height: 1 !important;\n    transform-origin: 0 0 !important;\n    text-rendering: geometricPrecision !important;\n  }\n`);\n\nexport default PDFViewerContainer;","// @ts-nocheck\nimport * as React from 'react';\n\ninterface PDFViewerDiagnosticsProps {\n  value: string;\n  height: string;\n}\n\nexport const PDFViewerDiagnostics: React.FC<PDFViewerDiagnosticsProps> = ({ value, height }) => {\n  const getValuePreview = (val: string) => {\n    if (!val) return 'No value';\n    if (val.length > 100) {\n      return `${val.substring(0, 100)}...`;\n    }\n    return val;\n  };\n\n  return (\n    <div style={{\n      background: '#f0f0f0',\n      border: '1px solid #ccc',\n      padding: '8px',\n      marginBottom: '8px',\n      fontSize: '12px',\n      fontFamily: 'monospace'\n    }}>\n      <strong>PDFViewer Diagnostics:</strong><br />\n      Value: {getValuePreview(value)}<br />\n      Height: {height}<br />\n      Value Length: {value?.length || 0}<br />\n      Is Base64: {value?.startsWith('data:') || /^([A-Za-z0-9+/=])+$/.test(value) ? 'Yes' : 'No'}<br />\n      Is URL: {value?.startsWith('http') ? 'Yes' : 'No'}<br />\n      Is Blob: {value?.startsWith('blob:') ? 'Yes' : 'No'}\n    </div>\n  );\n};","// @ts-nocheck\nimport * as React from 'react';\nimport { Viewer, Worker, SpecialZoomLevel } from '@react-pdf-viewer/core';\nimport { pageNavigationPlugin } from '@react-pdf-viewer/page-navigation';\nimport { zoomPlugin } from '@react-pdf-viewer/zoom';\nimport { searchPlugin } from '@react-pdf-viewer/search';\nimport { toolbarPlugin } from '@react-pdf-viewer/toolbar';\n\nimport '@react-pdf-viewer/core/lib/styles/index.css';\nimport '@react-pdf-viewer/default-layout/lib/styles/index.css';\n\nimport { withConfiguration } from '@pega/cosmos-react-core';\nimport { PDFViewerContainer, ViewerWrapper } from './styles';\nimport { PDFViewerDiagnostics } from './diagnostics';\n\n// Add global error handler for PDF.js to catch any canvas issues\nif (globalThis.window !== undefined) {\n  globalThis.window.addEventListener('error', (event) => {\n    if (event.message?.includes('pdf')) {\n      console.error('PDF.js error caught:', event.error, event.message);\n    }\n  });\n}\n\n// Simple interface for the component\nexport interface PDFViewerProps {\n  value?: string; // PDF source (URL or base64)\n  height?: string;\n  showToolbar?: boolean; // Toggle toolbar visibility\n  showDiagnostics?: boolean; // For debugging\n}\n\n// Helper function to check if URL contains base64 data\nfunction containsBase64Data(url: string): boolean {\n  try {\n    // Extract everything after the domain\n    const domainEndIndex = url.indexOf('/', url.indexOf('://') + 3);\n    if (domainEndIndex === -1) return false;\n    \n    const pathPart = url.substring(domainEndIndex + 1); // Skip the first /\n    \n    // Check if it contains PDF header (JVBER = %PDF in base64)\n    const hasPdfHeader = pathPart.includes('JVBER');\n    \n    // Also check if the majority of the content looks like base64\n    const base64LikeChars = (pathPart.match(/[A-Za-z0-9+/=%]/g) || []).length;\n    const totalChars = pathPart.length;\n    const base64Ratio = base64LikeChars / totalChars;\n    \n    return hasPdfHeader && base64Ratio > 0.8 && totalChars > 100;\n  } catch {\n    return false;\n  }\n}\n\n// Helper function to convert base64 to blob URL\nfunction convertBase64ToBlobUrl(input: string): string {\n  try {\n    let base64String = input.startsWith('data:application/pdf;base64,') \n      ? input.substring('data:application/pdf;base64,'.length)\n      : input;\n    \n    // Remove any whitespace\n    base64String = base64String.replaceAll(/\\s/g, '');\n    \n    // Pad base64 string to make length multiple of 4\n    const padding = (4 - (base64String.length % 4)) % 4;\n    if (padding > 0) {\n      base64String += '='.repeat(padding);\n      console.log('PDFViewer: Padded base64 string with', padding, 'equals');\n    }\n    \n    const binaryString = atob(base64String);\n    const bytes = new Uint8Array(binaryString.length);\n    \n    for (let i = 0; i < binaryString.length; i += 1) {\n      bytes[i] = binaryString.codePointAt(i) || 0;\n    }\n    \n    const blob = new Blob([bytes], { type: 'application/pdf' });\n    console.log('PDFViewer: Converted base64 to blob, size:', blob.size);\n    return URL.createObjectURL(blob);\n  } catch (error) {\n    console.error('PDFViewer: Failed to convert base64 to blob:', error);\n    return '';\n  }\n}\n\n// Helper function to extract base64 from URL and convert to blob\nfunction extractBase64FromUrl(url: string): string | null {\n  try {\n    // Extract everything after the domain\n    const domainEndIndex = url.indexOf('/', url.indexOf('://') + 3);\n    if (domainEndIndex === -1) {\n      throw new Error('No path found in URL');\n    }\n    \n    const pathPart = url.substring(domainEndIndex + 1); // Skip the first /\n    \n    // Find the last slash before JVBER\n    const lastSlashBeforeJvber = pathPart.lastIndexOf('/', pathPart.indexOf('JVBER'));\n    if (lastSlashBeforeJvber === -1) {\n      throw new Error('No slash found before JVBER');\n    }\n    \n    const base64String = pathPart.substring(lastSlashBeforeJvber + 1);\n    \n    // Try to decode URL encoding in the base64 string\n    let decodedBase64;\n    try {\n      decodedBase64 = decodeURIComponent(base64String);\n    } catch {\n      decodedBase64 = base64String;\n    }\n    \n    // Validate it's base64-like (allow spaces and some other chars)\n    const invalidChars = decodedBase64.match(/[^A-Za-z0-9+/=\\s]/g);\n    if (invalidChars) {\n      throw new Error('Invalid base64 characters');\n    }\n    \n    console.log('PDFViewer: Extracted base64 from URL path, converting to blob...');\n    const blobUrl = convertBase64ToBlobUrl(decodedBase64);\n    return blobUrl || null; // Return null if conversion failed\n  } catch (error) {\n    console.warn('PDFViewer: Failed to extract base64 from URL:', error);\n    return null; // Return null to indicate extraction failed\n  }\n}\n\n// Helper function to fetch PDF from URL\nasync function fetchPdfFromUrl(url: string): Promise<string> {\n  console.log('PDFViewer: Fetching PDF from URL:', url);\n  try {\n    const response = await fetch(url, {\n      mode: 'cors',\n      headers: { 'Accept': 'application/pdf' }\n    });\n    \n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n    \n    const blob = await response.blob();\n    console.log('PDFViewer: Successfully fetched PDF blob, size:', blob.size);\n    return URL.createObjectURL(blob);\n  } catch (error) {\n    console.warn('PDFViewer: Failed to fetch PDF:', error);\n    return url; // Fallback to direct URL\n  }\n}\n\n// Helper function to check if input is base64 data\nfunction isBase64Data(input: string): boolean {\n  if (input.startsWith('data:application/pdf;base64,')) return true;\n  return /^[A-Za-z0-9+/=\\s]+$/.test(input);\n}\n\n// Convert base64 to blob URL if needed, or handle external URLs\nasync function processUrl(input: string): Promise<string> {\n  if (!input) return '';\n  \n  // If it's already a blob URL, return as-is\n  if (input.startsWith('blob:')) {\n    return input;\n  }\n  \n  // Check if HTTP URL contains base64 data (Pega workaround)\n  if ((input.startsWith('http://') || input.startsWith('https://')) && containsBase64Data(input)) {\n    const extracted = extractBase64FromUrl(input);\n    if (extracted) {\n      return extracted; // Successfully extracted and converted\n    }\n    // If extraction failed, don't try to fetch the long URL to avoid 414 error\n    console.warn('PDFViewer: Detected base64 data in URL but failed to extract, skipping fetch to avoid 414 error');\n    return ''; // Return empty to indicate failure\n  }\n  \n  // If it's an HTTP/HTTPS URL, try to fetch it\n  if (input.startsWith('http://') || input.startsWith('https://')) {\n    return await fetchPdfFromUrl(input);\n  }\n  \n  // If it's base64, convert to blob URL\n  if (isBase64Data(input)) {\n    return convertBase64ToBlobUrl(input);\n  }\n  \n  return input;\n}\n\n// PDF.js worker URL - try multiple CDNs for reliability\nconst WORKER_URLS = [\n  'https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js',  \n  'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js',\n  'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js'\n];\n\n// Try to use a worker that matches our version more closely\nconst WORKER_URL = WORKER_URLS[1]; // Try jsdelivr instead\n\nconst PDFViewer: React.FC<PDFViewerProps> = ({\n  value = '',\n  height = '600px',\n  showToolbar = true,\n  showDiagnostics = false\n}) => {\n  const [pdfUrl, setPdfUrl] = React.useState('');\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [error, setError] = React.useState('');\n  const [numPages, setNumPages] = React.useState<number>(0);\n  const [isDocumentReady, setIsDocumentReady] = React.useState(false);\n\n  const wrapperRef = React.useRef<HTMLDivElement | null>(null);\n  const normalizedValue = React.useMemo(() => (typeof value === 'string' ? value : ''), [value]);\n\n  const toolbarPluginInstance = toolbarPlugin();\n  const { Toolbar } = toolbarPluginInstance;\n  const pageNavigationPluginInstance = pageNavigationPlugin();\n  const zoomPluginInstance = zoomPlugin();\n  const searchPluginInstance = searchPlugin();\n\n  const plugins = React.useMemo(\n    () => [\n      toolbarPluginInstance,\n      pageNavigationPluginInstance,\n      zoomPluginInstance,\n      searchPluginInstance\n    ],\n    [toolbarPluginInstance, pageNavigationPluginInstance, zoomPluginInstance, searchPluginInstance]\n  );\n\n  // External search integration - listen for TextInputSearch events\n  React.useEffect(() => {\n    const handlePDFSearch = (event: CustomEvent) => {\n      const { searchText } = event.detail;\n      if (searchText && typeof searchText === 'string') {\n        console.log('PDFViewer: Received external search request:', searchText);\n\n        // Trigger programmatic search using the search plugin\n        try {\n          if (searchPluginInstance && pdfUrl && !isLoading && isDocumentReady) {\n            searchPluginInstance.highlight(searchText).then(matches => {\n              console.log('PDFViewer: Programmatic search triggered for:', searchText, 'Found matches:', matches.length, 'PDF loaded:', !!pdfUrl, 'Loading:', isLoading, 'Document ready:', isDocumentReady);\n            }).catch(searchError => {\n              console.error('PDFViewer: Search failed:', searchError);\n            });\n          } else {\n            console.warn('PDFViewer: Cannot search - search plugin not available or PDF not ready yet. Plugin:', !!searchPluginInstance, 'URL:', pdfUrl, 'Loading:', isLoading, 'Document ready:', isDocumentReady);\n          }\n        } catch (searchError) {\n          console.error('PDFViewer: Could not trigger programmatic search:', searchError);\n        }\n      }\n    };\n\n    // Listen for various search events dispatched by TextInputSearch\n    globalThis.addEventListener('pdfViewerSearch', handlePDFSearch as EventListener);\n    globalThis.addEventListener('simplePdfViewerSearch', handlePDFSearch as EventListener);\n\n    // Register global PDF viewer API\n    (globalThis as any).pdfViewer = {\n      search: (searchText: string) => {\n        console.log('PDFViewer: Direct API search called:', searchText);\n        if (searchPluginInstance && pdfUrl && !isLoading && isDocumentReady) {\n          searchPluginInstance.highlight(searchText).then(matches => {\n            console.log('PDFViewer: Direct API search executed for:', searchText, 'Found matches:', matches.length, 'PDF loaded:', !!pdfUrl, 'Loading:', isLoading, 'Document ready:', isDocumentReady);\n            return matches.length > 0;\n          }).catch(searchError => {\n            console.error('PDFViewer: Direct API search failed:', searchError);\n            return false;\n          });\n          return true; // Return true to indicate search was attempted\n        } else {\n          console.warn('PDFViewer: Direct API cannot search - search plugin not available or PDF not ready yet. Plugin:', !!searchPluginInstance, 'URL:', pdfUrl, 'Loading:', isLoading, 'Document ready:', isDocumentReady);\n          return false;\n        }\n      }\n    };\n\n    return () => {\n      globalThis.removeEventListener('pdfViewerSearch', handlePDFSearch as EventListener);\n      globalThis.removeEventListener('simplePdfViewerSearch', handlePDFSearch as EventListener);\n      delete (globalThis as any).pdfViewer;\n    };\n  }, [searchPluginInstance, pdfUrl, isLoading, isDocumentReady]);\n\n  // Process the PDF source when it changes\n  React.useEffect(() => {\n    console.log('PDFViewer: Processing value:', normalizedValue);\n    console.log('PDFViewer: Container dimensions:', { height, width: '100%' });\n    console.log('PDFViewer: Toolbar enabled:', showToolbar);\n    setError('');\n    setIsDocumentReady(false); // Reset document ready state\n\n    if (!normalizedValue) {\n      setPdfUrl('');\n      setIsLoading(false);\n      return;\n    }\n\n    setIsLoading(true);\n\n    // Handle async URL processing\n    const loadPdf = async () => {\n      try {\n        const processedUrl = await processUrl(normalizedValue);\n        console.log('PDFViewer: Processed URL:', processedUrl);\n        setPdfUrl(processedUrl);\n        setIsLoading(false);\n      } catch (err) {\n        console.error('Error processing PDF URL:', err);\n        setError('Failed to load PDF');\n        setIsLoading(false);\n      }\n    };\n\n    loadPdf();\n  }, [normalizedValue]);\n\n  // Process the PDF source when it changes  // Render the component\n  const renderContent = () => {\n    if (error) {\n      return (\n        <div\n          style={{\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            height: '100%',\n            color: '#666',\n            fontSize: '16px'\n          }}\n        >\n          {error}\n        </div>\n      );\n    }\n\n    if (pdfUrl) {\n      return (\n        <div\n          style={{\n            flex: 1,\n            overflow: 'auto',\n            height: '100%'\n          }}\n        >\n          <Worker workerUrl={WORKER_URL}>\n            <Viewer\n              fileUrl={pdfUrl}\n              plugins={plugins}\n              defaultScale={SpecialZoomLevel.PageWidth}\n              characterMap={{\n                isCompressed: true,\n                url: 'https://unpkg.com/pdfjs-dist@3.11.174/cmaps/'\n              }}\n              onDocumentLoad={(event: any) => {\n                const totalPages = event?.doc?.numPages ?? 0;\n                console.log('PDFViewer: Document loaded with', totalPages, 'pages.');\n                setNumPages(totalPages);\n                setIsDocumentReady(true);\n              }}\n\n            />\n          </Worker>\n        </div>\n      );\n    }\n\n    if (isLoading) {\n      return (\n        <div\n          style={{\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            height: '100%',\n            color: '#666',\n            fontSize: '16px'\n          }}\n        >\n          Loading PDF...\n        </div>\n      );\n    }\n\n    return (\n      <div\n        style={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: '100%',\n          color: '#666',\n          fontSize: '16px'\n        }}\n      >\n        No PDF provided\n      </div>\n    );\n  };\n\n  return (\n    <PDFViewerContainer style={{ height: height || '600px' }}>\n      {showToolbar && pdfUrl && <Toolbar />}\n      <ViewerWrapper\n        className=\"pega-pdfviewer-wrapper\"\n        ref={wrapperRef}\n        data-testid=\"pdf-viewer-wrapper\"\n      >\n        {showDiagnostics && <PDFViewerDiagnostics value={value} height={height} />}\n        {renderContent()}\n      </ViewerWrapper>\n      {showDiagnostics && (\n        <div\n          style={{\n            position: 'absolute',\n            right: 12,\n            bottom: 12,\n            background: 'rgba(255,255,255,0.9)',\n            border: '1px solid #ddd',\n            padding: '8px',\n            fontSize: 12,\n            zIndex: 1000\n          }}\n        >\n          <div style={{ fontWeight: 600 }}>PDFViewer debug</div>\n          <div>isLoading: {String(isLoading)}</div>\n          <div>numPages: {numPages}</div>\n\n          <div style={{ maxWidth: 480, whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n            url: {pdfUrl || '(empty)'}\n          </div>\n          {error && <div style={{ color: 'red' }}>error: {error}</div>}\n        </div>\n      )}\n    </PDFViewerContainer>\n  );\n};\n\nexport { PDFViewer };\nexport default withConfiguration(PDFViewer);"],"names":["PDFViewerContainer","styled","div","css","ViewerWrapper","PDFViewerDiagnostics","value","height","_jsxs","style","background","border","padding","marginBottom","fontSize","fontFamily","children","_jsx","val","length","substring","startsWith","test","convertBase64ToBlobUrl","input","base64String","replaceAll","repeat","console","log","binaryString","atob","bytes","Uint8Array","i","codePointAt","blob","Blob","type","size","URL","createObjectURL","error","undefined","globalThis","window","addEventListener","event","message","includes","PDFViewer","showToolbar","showDiagnostics","pdfUrl","setPdfUrl","React","isLoading","setIsLoading","setError","numPages","setNumPages","isDocumentReady","setIsDocumentReady","wrapperRef","normalizedValue","toolbarPluginInstance","toolbarPlugin","Toolbar","pageNavigationPluginInstance","pageNavigationPlugin","zoomPluginInstance","zoomPlugin","searchPluginInstance","searchPlugin","plugins","handlePDFSearch","searchText","detail","highlight","then","matches","catch","searchError","warn","pdfViewer","search","removeEventListener","width","async","processedUrl","url","domainEndIndex","indexOf","pathPart","hasPdfHeader","base64LikeChars","match","totalChars","containsBase64Data","Error","lastSlashBeforeJvber","lastIndexOf","decodedBase64","decodeURIComponent","extractBase64FromUrl","response","fetch","mode","headers","ok","status","statusText","fetchPdfFromUrl","isBase64Data","processUrl","err","loadPdf","className","ref","display","justifyContent","alignItems","color","flex","overflow","Worker","workerUrl","Viewer","fileUrl","defaultScale","SpecialZoomLevel","PageWidth","characterMap","isCompressed","onDocumentLoad","totalPages","doc","position","right","bottom","zIndex","fontWeight","String","maxWidth","whiteSpace","textOverflow","withConfiguration"],"sourceRoot":""}