/*! For license information please see Aja100_Any_jaygasi_PDFViewerAdvanced.a07b50f3.js.LICENSE.txt */
(self.webpackChunkj251=self.webpackChunkj251||[]).push([[43714693],{1306:(e,t,n)=>{"use strict";var r,o=n(6096),i=function(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}(n(1594));!function(e){e.NoSelection="NoSelection",e.Selecting="Selecting",e.Selected="Selected",e.Selection="Selection",e.ClickDragging="ClickDragging",e.ClickDragged="ClickDragged"}(r||(r={}));var a,c={height:0,left:0,pageIndex:-1,top:0,width:0},s={highlightAreas:[],selectionRegion:c,type:r.NoSelection},l={highlightAreas:[],selectionRegion:c,type:r.Selecting},d=function(e){var t=e.canvasLayerRef,n=e.canvasLayerRendered,o=e.pageIndex,a=e.store,c=e.textLayerRef,l=e.textLayerRendered,d=i.useRef(),g=i.useRef(document.body.style.cursor),u=i.useRef({x:0,y:0}),h=i.useRef({top:0,left:0}),f=function(){var e=d.current;e&&e.classList.add("rpv-highlight__click-drag--hidden")},p=function(e){var t=c.current,n=d.current;if(e.altKey&&t&&n&&0===e.button){e.preventDefault(),document.body.style.cursor="crosshair";var o=t.getBoundingClientRect(),i={x:e.clientX,y:e.clientY};u.current=i;var s={top:100*(i.y-o.top)/o.height,left:100*(i.x-o.left)/o.width};h.current=s,n.style.top="".concat(s.top,"%"),n.style.left="".concat(s.left,"%"),n.style.height="0px",n.style.width="0px",document.addEventListener("mousemove",v),document.addEventListener("mouseup",x),a.updateCurrentValue("highlightState",function(e){return Object.assign({},e,{type:r.ClickDragging})})}},v=function(e){var t=c.current,n=d.current;if(t&&n){e.preventDefault();var r=e.clientX-u.current.x,o=e.clientY-u.current.y,i=t.getBoundingClientRect();n.classList.contains("rpv-highlight__click-drag--hidden")&&n.classList.remove("rpv-highlight__click-drag--hidden");var a=Math.min(100-h.current.left,100*r/i.width),s=Math.min(100-h.current.top,100*o/i.height);n.style.width="".concat(a,"%"),n.style.height="".concat(s,"%")}},m=function(e){"Escape"===e.key&&a.get("highlightState").type===r.ClickDragged&&(e.preventDefault(),f(),a.update("highlightState",s))},y=function(e){var t=d.current;t&&a.get("highlightState").type===r.NoSelection&&e.target!==t&&f()},x=function(e){e.preventDefault(),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",x),b();var n=d.current,i=t.current;if(n&&i){var c,s,l={pageIndex:o,top:parseFloat(n.style.top.slice(0,-1)),left:parseFloat(n.style.left.slice(0,-1)),height:parseFloat(n.style.height.slice(0,-1)),width:parseFloat(n.style.width.slice(0,-1))},g=(c=document.createElement("canvas"),s=window.devicePixelRatio||1,function(e,t){var n=e.getBoundingClientRect(),r=t.left*n.width/100,o=t.top*n.height/100,i=t.width*n.width/100,a=t.height*n.height/100,l=c.getContext("2d");return c.width=i,c.height=a,null==l||l.drawImage(e,r*s,o*s,i*s,a*s,0,0,i,a),c.toDataURL("image/png")})(i,l),u={highlightAreas:[l],previewImage:g,selectionRegion:l,type:r.ClickDragged};a.update("highlightState",u)}},b=function(){g.current?document.body.style.cursor=g.current:document.body.style.removeProperty("cursor")},w=function(e){(e.type===r.Selection||e.type===r.ClickDragging&&e.selectionRegion.pageIndex!==o)&&f()};return i.useEffect(function(){return a.subscribe("highlightState",w),function(){a.unsubscribe("highlightState",w)}},[]),i.useEffect(function(){var e=t.current,r=c.current;if(n&&l&&e&&r){r.addEventListener("mousedown",p);var o={capture:!0};return document.addEventListener("keydown",m),document.addEventListener("click",y,o),function(){r.removeEventListener("mousedown",p),document.removeEventListener("click",y,o),document.removeEventListener("keydown",m)}}},[l]),i.createElement("div",{ref:d,className:"rpv-highlight__click-drag rpv-highlight__click-drag--hidden"})},g="data-highlight-text-layer",u="data-highlight-text-page",h=function(e){return e>=0?e:360+e},f=function(e,t){switch(h(t)){case 90:return{height:"".concat(e.width,"%"),position:"absolute",right:"".concat(e.top,"%"),top:"".concat(e.left,"%"),width:"".concat(e.height,"%")};case 180:return{bottom:"".concat(e.top,"%"),height:"".concat(e.height,"%"),position:"absolute",right:"".concat(e.left,"%"),width:"".concat(e.width,"%")};case 270:return{height:"".concat(e.width,"%"),position:"absolute",left:"".concat(e.top,"%"),bottom:"".concat(e.left,"%"),width:"".concat(e.height,"%")};default:return{height:"".concat(e.height,"%"),position:"absolute",top:"".concat(e.top,"%"),left:"".concat(e.left,"%"),width:"".concat(e.width,"%")}}},p=function(e){var t=e.area,n=e.rotation;return i.createElement("div",{className:"rpv-highlight__selected-text",style:f(t,n)})},v=function(e){var t=i.useState(e.get("rotation")||0),n=t[0],r=t[1],o=function(e){return r(e)};return i.useEffect(function(){return e.subscribe("rotation",o),function(){e.unsubscribe("rotation",o)}},[]),{rotation:n}},m=function(e){var t=e.pageIndex,n=e.renderHighlightContent,o=e.renderHighlightTarget,a=e.renderHighlights,c=e.store,l=i.useState(c.get("highlightState")),d=l[0],g=l[1],u=v(c).rotation,h=function(e){return g(e)},m=function(){window.getSelection().removeAllRanges(),c.update("highlightState",s)};i.useEffect(function(){return c.subscribe("highlightState",h),function(){c.unsubscribe("highlightState",h)}},[]);var y=d.type===r.Selection?d.highlightAreas.filter(function(e){return e.pageIndex===t}):[];return i.createElement(i.Fragment,null,o&&(d.type===r.Selected||d.type===r.ClickDragged)&&d.selectionRegion.pageIndex===t&&o({highlightAreas:d.highlightAreas,previewImage:d.previewImage||"",selectedText:d.selectedText||"",selectionRegion:d.selectionRegion,selectionData:d.selectionData,cancel:m,toggle:function(){var e=Object.assign({},d,{type:r.Selection});c.update("highlightState",e),window.getSelection().removeAllRanges()}}),n&&d.type==r.Selection&&d.selectionRegion.pageIndex===t&&n({highlightAreas:d.highlightAreas,previewImage:d.previewImage||"",selectedText:d.selectedText||"",selectionRegion:d.selectionRegion,selectionData:d.selectionData,cancel:m}),y.length>0&&i.createElement("div",null,y.map(function(e,t){return i.createElement(p,{key:t,area:e,rotation:u})})),a&&a({pageIndex:t,rotation:u,getCssProperties:f}))};t.l=void 0,(a=t.l||(t.l={})).None="None",a.TextSelection="TextSelection";var y,x=function(e,t,n){var r=e.cloneNode(!0);e.parentNode.appendChild(r);var o=r.firstChild,i=new Range;i.setStart(o,t),i.setEnd(o,n);var a=document.createElement("span");i.surroundContents(a);var c=a.getBoundingClientRect();return r.parentNode.removeChild(r),c},b=function(e,t,n,r,o,i){if(n<o){var a=e.slice(n,n+1).map(function(e){return e.textContent.substring(r).trim()}).join(" "),c=e.slice(n+1,o).map(function(e){return e.textContent.trim()}).join(" "),s=e.slice(o,o+1).map(function(e){return e.textContent.substring(0,i||e.textContent.length)}).join(" "),l="".concat(a," ").concat(c," ").concat(s);return{divTexts:e.slice(n,o+1).map(function(e,r){return{divIndex:n+r,pageIndex:t,textContent:e.textContent}}),wholeText:l}}var d=e[n];return l=d.textContent.substring(r,i||d.textContent.length).trim(),{divTexts:[{divIndex:n,pageIndex:t,textContent:d.textContent}],wholeText:l}};!function(e){e.SameDiv="SameDiv",e.DifferentDivs="DifferentDivs",e.DifferentPages="DifferentPages"}(y||(y={}));var w=["","\n"],A=function(e){var n=e.store,o=v(n).rotation,a=i.useRef(null),c=i.useState(!1),s=c[0],l=c[1],d=i.useState(n.get("trigger")),f=d[0],p=d[1],m=function(e){var t=e();a.current=t,l(!!t)},A=function(e){return p(e)},S=function(){var e=document.getSelection(),t=n.get("highlightState");if((t.type===r.NoSelection||t.type===r.Selected)&&e.rangeCount>0&&-1===w.indexOf(e.toString())){var i,a,c=e.getRangeAt(0),s=c.startContainer.parentNode,l=c.endContainer.parentNode,d=l instanceof HTMLElement&&l.hasAttribute(g);if(s&&s.parentNode==c.endContainer?a=(i=s).textContent.length:d&&0==c.endOffset?a=(i=c.endContainer.previousSibling).textContent.length:d?(i=c.endContainer,a=c.endOffset):(i=l,a=c.endOffset),s instanceof HTMLElement&&i instanceof HTMLElement){var f=parseInt(s.getAttribute(u),10),p=parseInt(i.getAttribute(u),10),v=s.parentElement,m=i.parentElement,A=v.getBoundingClientRect(),S=[].slice.call(v.querySelectorAll("[".concat(u,"]"))),P=S.indexOf(s),$=m.getBoundingClientRect(),D=[].slice.call(m.querySelectorAll("[".concat(u,"]"))),C=D.indexOf(i),R=c.startOffset,E=y.DifferentPages;switch(!0){case f===p&&P===C:E=y.SameDiv;break;case f===p&&P<C:E=y.DifferentDivs;break;default:E=y.DifferentPages}var F=function(e,t,n){return Array(t-e+1).fill(0).map(function(t,r){return n[e+r].getBoundingClientRect()})},I=[];switch(E){case y.SameDiv:var k=x(s,R,a);I=[{height:100*k.height/A.height,left:100*(k.left-A.left)/A.width,pageIndex:f,top:100*(k.top-A.top)/A.height,width:100*k.width/A.width}];break;case y.DifferentDivs:I=[x(s,R,s.textContent.length)].concat(F(P+1,C-1,S)).concat([x(i,0,a)]).map(function(e){return{height:100*e.height/A.height,left:100*(e.left-A.left)/A.width,pageIndex:f,top:100*(e.top-A.top)/A.height,width:100*e.width/A.width}});break;case y.DifferentPages:var j=[x(s,R,s.textContent.length)].concat(F(P+1,S.length-1,S)).map(function(e){return{height:100*e.height/A.height,left:100*(e.left-A.left)/A.width,pageIndex:f,top:100*(e.top-A.top)/A.height,width:100*e.width/A.width}}),T=F(0,C-1,D).concat([x(i,0,a)]).map(function(e){return{height:100*e.height/$.height,left:100*(e.left-$.left)/$.width,pageIndex:p,top:100*(e.top-$.top)/$.height,width:100*e.width/$.width}});I=j.concat(T)}var L,H="",O=[];switch(E){case y.SameDiv:var V=b(S,f,P,R,P,a);H=V.wholeText,O=V.divTexts;break;case y.DifferentDivs:var N=b(S,f,P,R,C,a);H=N.wholeText,O=N.divTexts;break;case y.DifferentPages:var B=b(S,f,P,R,S.length),_=b(D,p,0,0,C,a);H="".concat(B.wholeText,"\n").concat(_.wholeText),O=B.divTexts.concat(_.divTexts)}if(I.length>0)L=I[I.length-1];else{var q=i.getBoundingClientRect();L={height:100*q.height/$.height,left:100*(q.left-$.left)/$.width,pageIndex:p,top:100*(q.top-$.top)/$.height,width:100*q.width/$.width}}var U={divTexts:O,selectedText:H,startPageIndex:f,endPageIndex:p,startOffset:R,startDivIndex:P,endOffset:a,endDivIndex:C},W={type:r.Selected,selectedText:H,highlightAreas:I.map(function(e){return function(e,t){switch(h(t)){case 90:return{height:e.width,left:e.top,pageIndex:e.pageIndex,top:100-e.width-e.left,width:e.height};case 180:return{height:e.height,left:100-e.width-e.left,pageIndex:e.pageIndex,top:100-e.height-e.top,width:e.width};case 270:return{height:e.width,left:100-e.height-e.top,pageIndex:e.pageIndex,top:e.left,width:e.height};default:return e}}(e,o)}),selectionData:U,selectionRegion:L};n.update("highlightState",W)}}};return i.useEffect(function(){var e=a.current;if(e&&f!==t.l.None)return e.addEventListener("mouseup",S),function(){e.removeEventListener("mouseup",S)}},[s,f,o]),i.useEffect(function(){return n.subscribe("getPagesContainer",m),n.subscribe("trigger",A),function(){n.unsubscribe("getPagesContainer",m),n.unsubscribe("trigger",A)}},[]),i.createElement(i.Fragment,null)},S="rpv-highlight__selected-end";t.highlightPlugin=function(e){var n=Object.assign({},{trigger:t.l.TextSelection},e),a=i.useMemo(function(){return o.createStore({highlightState:s,trigger:n.trigger})},[]);return{install:function(e){a.update("jumpToDestination",e.jumpToDestination),a.update("getPagesContainer",e.getPagesContainer)},onViewerStateChange:function(e){return a.update("rotation",e.rotation),e},onTextLayerRender:function(e){var n,i=(n=e,function(e){if(a.get("trigger")!==t.l.None&&0===e.button){var o=n.ele,i=o.getBoundingClientRect(),c=a.get("highlightState");if(c.type===r.Selected){var d=e.clientY-i.top,g=e.clientX-i.left;c.highlightAreas.filter(function(e){return e.pageIndex===n.pageIndex}).find(function(e){var t=e.top*i.height/100,n=e.left*i.width/100,r=e.height*i.height/100,o=e.width*i.width/100;return t<=d&&d<=t+r&&n<=g&&g<=n+o})?(window.getSelection().removeAllRanges(),a.update("highlightState",s)):a.update("highlightState",l)}else a.update("highlightState",s);var u=100*(e.clientY-i.top)/i.height,h=o.querySelector(".".concat(S));h&&e.target!==o&&(h.style.top="".concat(Math.max(0,u),"%"))}}),c=function(e){return function(n){if(a.get("trigger")!==t.l.None){var r=e.ele.querySelector(".".concat(S));r&&r.style.removeProperty("top")}}}(e),d=e.ele;if(e.status===o.LayerRenderStatus.PreRender){d.removeEventListener("mousedown",i),d.removeEventListener("mouseup",c);var h=d.querySelector(".".concat(S));h&&d.removeChild(h)}else if(e.status===o.LayerRenderStatus.DidRender&&(d.addEventListener("mousedown",i),d.addEventListener("mouseup",c),d.setAttribute(g,"true"),d.querySelectorAll(".rpv-core__text-layer-text").forEach(function(t){return t.setAttribute(u,"".concat(e.pageIndex))}),!d.querySelector(".".concat(S)))){var f=document.createElement("div");f.classList.add(S),f.classList.add("rpv-core__text-layer-text--not"),d.appendChild(f)}},renderPageLayer:function(e){return i.createElement(i.Fragment,null,i.createElement(d,{canvasLayerRef:e.canvasLayerRef,canvasLayerRendered:e.canvasLayerRendered,pageIndex:e.pageIndex,store:a,textLayerRef:e.textLayerRef,textLayerRendered:e.textLayerRendered}),i.createElement(m,{pageIndex:e.pageIndex,renderHighlightContent:n.renderHighlightContent,renderHighlightTarget:n.renderHighlightTarget,renderHighlights:n.renderHighlights,store:a}))},renderViewer:function(e){var t=e.slot;return t.subSlot&&t.subSlot.children&&(t.subSlot.children=i.createElement(i.Fragment,null,i.createElement(A,{store:a}),t.subSlot.children)),t},jumpToHighlightArea:function(e){var t=a.get("jumpToDestination");t&&t({pageIndex:e.pageIndex,bottomOffset:function(t,n){return(100-e.top)*n/100},leftOffset:function(t,n){return(100-e.left)*t/100}})},switchTrigger:function(e){a.update("trigger",e)}}}},1815:()=>{},2093:(e,t,n)=>{"use strict";e.exports=n(1306)},2694:(e,t,n)=>{"use strict";var r=n(6925);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},2787:()=>{},3237:()=>{},4325:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>F});var r=n(1594),o=n.n(r),i=n(6096),a=n(2093),c=n(5099),s=n(7501),l=n(4848),d=n(8267),g=n(1357),u=n(7321),h=n(9549),f=n(9187),p=n(4869),v=n(8579),m=n(7491),y=n(8866);const x=d.Ay.span(({theme:e,variant:t,afterContent:n})=>{const{spacing:r}=e.base,o=e.base["border-radius"],{"font-stretch":i,status:a}=e.components.badges,{background:c,foreground:s}=a[t],l=(0,f.A)(()=>(0,g.B3)(s,.1)),h=(0,u.Vr)(e.base["font-size"],e.base["font-scale"]);return d.AH`
    display: inline-block;
    position: relative;
    background-color: ${c};
    border-radius: calc(0.25 * ${o});
    color: ${s};
    box-shadow: inset 0 0 0 0.0625rem ${l};
    font-size: ${h.xxs};
    font-weight: bold;
    font-stretch: ${i};
    line-height: 1rem;
    padding-inline: calc(${r} / 2);

    &::after {
      content: '${n}' / '';
      text-transform: uppercase;
    }
  `});x.defaultProps=h.qn;const b=(0,p.A)((0,r.forwardRef)(function({testId:e,variant:t="info",children:n,...r},o){const i=(0,v.A)(e,y.XP);return(0,l.jsx)(x,{"data-testid":i.root,...r,variant:t,ref:o,afterContent:n,children:(0,l.jsx)(m.A,{children:`${n}`})})}),y.XP);var w=n(7521),A=n(1093),S=n(5556),P=n.n(S);const $=(e,t)=>{console.error(t,e)};console.log("PDFViewerAdvanced module loaded");const D=e=>{const{viewport:t,textContentSource:n}=e,r=o().useRef(null);return o().useEffect(()=>{(async()=>{const o=await n.promise;if(r.current){r.current.innerHTML="";for(const n of o.items){const o=document.createElement("span"),i=n.fontName.split("-")[0].split("+")[1]||"sans-serif",a=e.applyTransform({...n.style,fontFamily:i,color:"transparent"},{transform:t.transform.concat([1,0,0,1,-1,-1])});for(const e of Object.keys(a))o.style[e]=a[e];o.textContent=n.str,r.current.appendChild(o)}}})()},[n,t,e]),o().createElement("div",{ref:r,className:"rpv-core__text-layer",style:{...e.style,width:`${t.width}px`,height:`${t.height}px`}})},C=e=>(0,l.jsx)(D,{...e});D.propTypes={viewport:P().shape({width:P().number,height:P().number,transform:P().arrayOf(P().number)}).isRequired,textContentSource:P().shape({promise:P().object}).isRequired,applyTransform:P().func.isRequired,style:P().object.isRequired};const R=e=>e?e.startsWith(".")?e:`.${e}`:e,E=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){const t=e.pyFileSource??e.pyStream??e.pyBinaryStream??e.pyBase64??e.value;if("string"==typeof t)return t}return""};console.log("PDFViewerAdvanced component exported with withConfiguration");const F=(0,A.A)(e=>{const{getPConnect:t,value:n=""}=e,[o,d]=(0,r.useState)(null),g=async e=>{try{return(await fetch(e,{method:"HEAD"})).ok}catch(t){const n=t instanceof Error?t.message:String(t);return console.warn(`PDFViewerAdvanced: Worker check failed for candidate URL: ${e}. Error: ${n}`),!1}};(0,r.useEffect)(()=>{(async()=>{const e=t?.(),n=e&&"function"==typeof e.getEnvironmentInfo?e.getEnvironmentInfo():void 0,r=(e=>{const t=e.endsWith("/")?e:`${e}/`;return[e?`${t}webwb/PDFWorkerMin.js`:null,"/prweb/webwb/PDFWorkerMin.js","https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js"].filter(Boolean)})(n&&"function"==typeof n.getPublicPath?n.getPublicPath():"");for(const e of r)if(await g(e))return console.log(`PDFViewerAdvanced: Successfully validated worker script at: ${e}`),void d(e);console.error("PDFViewerAdvanced: FATAL - Could not find a valid PDF.js worker script. PDF functionality will be disabled. Searched paths:",r)})()},[t]);const u=t?.(),h=u?.getConfigProps?.()??{};console.log("PDFViewerAdvanced component received props:",Object.keys(e)),console.log("PDFViewerAdvanced full props:",e),console.log("PDFViewerAdvanced configProps:",h),console.log("PDFViewerAdvanced value prop:",n);const f=h.height??e.height??"600px",p=h.textHighlightJSON??e.textHighlightJSON,v=h.coordinateHighlightJSON??e.coordinateHighlightJSON,m="boolean"==typeof h.enableSearch?h.enableSearch:e.enableSearch??!1,y="boolean"==typeof h.enableDebugging?h.enableDebugging:e.enableDebugging??!1,x=h.pdfProperty??e.pdfProperty,A=h.onSelectProperty??e.onSelectProperty,S=h.searchPropRef??e.searchPropRef,P=h.confidenceFilter??e.confidenceFilter,[D,F]=(0,r.useState)(n||"");(0,r.useEffect)(()=>{console.log("PDFViewerAdvanced: pdfProperty effect triggered",{value:n,pdfProperty:x})},[n,x]);const I="string"==typeof A?A.trim():"",k="string"==typeof S?S.trim():"",j=(0,r.useCallback)(e=>{if(!I||!u)return;const t=((e,t,n)=>{if(!e||"function"!=typeof e.setValue||!t)return!1;const r=t.trim();if(!r)return!1;const o=r.startsWith(".")?[r,r.slice(1)]:[r,R(r)],i=Array.from(new Set(o.filter(Boolean)));for(const t of i)try{return e.setValue(t,n,n),!0}catch(e){$(e,`PDFViewerAdvanced: error writing value to ${t}`)}return!1})(u,I,e);t||$(`PDFViewerAdvanced: unable to write highlight selection '${e}' to ${I}`)},[I,u]);console.log("PDFViewerAdvanced component rendered."),(0,r.useEffect)(()=>{if(y&&k&&u&&"function"==typeof u.getValue)try{const e=u.getValue(k);console.log("PDFViewerAdvanced: current search property value",{property:k,currentValue:e})}catch(e){$(e,`PDFViewerAdvanced: error reading search property ${k}`)}},[y,k,u]),(0,r.useEffect)(()=>{if(console.log("PDFViewerAdvanced: PDF source resolution effect",{value:n,pdfProperty:x,pConnect:u}),n&&"string"==typeof n&&""!==n.trim())return console.log("PDFViewerAdvanced: using bound value property for PDF source",n),void F(n);const e="string"==typeof x?x.trim():"";if(console.log("PDFViewerAdvanced: resolved propRef for pdfProperty",e),!e)return console.log("PDFViewerAdvanced: no pdfProperty configured and bound value empty"),void F("");if(!u||"function"!=typeof u.getValue)return void console.log("PDFViewerAdvanced: pConnect unavailable when attempting to read pdfProperty");let t=!1,r=0;const o=()=>{if(t)return;r+=1;const n=((e,t)=>{if(!e||"function"!=typeof e.getValue||!t)return"";const n=t.trim(),r=[n];n.startsWith(".")?r.push(n.slice(1)):r.push(R(n));for(const t of r){let n;try{n=e.getValue(t)}catch(e){const n=e instanceof Error?e.message:String(e);$(new Error(`Failed to read PDF property: ${n}`),`PDFViewerAdvanced: error reading pdfProperty ${t}`);continue}const r=E(n);if(r)return r}return""})(u,e);if(console.log(`PDFViewerAdvanced: attempt ${r} to resolve pdfProperty`,{candidate:e,resolved:n}),n)return console.log(`PDFViewerAdvanced: resolved pdfProperty '${e}' on attempt ${r}`,n),void F(n);r<6?setTimeout(o,250):console.warn(`PDFViewerAdvanced: unable to resolve pdfProperty '${e}' after ${r} attempts`)};return o(),()=>{t=!0}},[n,x,u,y]);const T=D;console.log("PDFViewerAdvanced: final resolvedPdfBase64",T?T.substring(0,100):"[empty]");const L="string"==typeof P&&t?((e,t)=>{if("string"==typeof e&&e.startsWith(".")){const n=t();return n&&"function"==typeof n.getValue?n.getValue(e):($("getPConnect().getValue is not available to resolve property",e),e)}return e})(P,()=>t()):P;console.log("PDFViewerAdvanced PDF processing:",{pdfBase64:T?`${T.substring(0,50)}...`:"null/empty",pdfBase64Length:T?.length||0,pdfPropertyConfig:x||"not set",confidenceFilterResolved:L});const H=(0,r.useMemo)(()=>{const e="string"==typeof v?v:"";if(!e||""===e.trim())return[];try{const t=JSON.parse(e.trim());let n=Array.isArray(t)?t:t.pxResults||[];if(n=n.filter(e=>e&&"object"==typeof e&&e.boundingBox&&"number"==typeof e.pageIndex&&"number"==typeof e.confidence),L){const e=Number.parseFloat(L);n=n.filter(t=>t.confidence>=e)}return n}catch(e){return $(e,"Error parsing coordinateHighlightJSON:"),[]}},[v,L]),O=(0,r.useMemo)(()=>{const e="string"==typeof p?p:"";if(console.log("Processing text highlights from JSON:",{rawJSON:e,enableDebugging:y}),!e||""===e.trim())return console.log("No text highlight JSON provided"),[];try{const t=JSON.parse(e.trim());console.log("Parsed highlight JSON:",t);let n=[];if(Array.isArray(t)?n=t:t.textHighlights&&Array.isArray(t.textHighlights)&&(n=t.textHighlights),console.log("Initial highlights array:",n),n=n.filter(e=>{const t=e&&"object"==typeof e&&"string"==typeof e.text&&""!==e.text.trim()&&"number"==typeof e.confidence;return!t&&y&&console.log("Invalid highlight entry:",e),t}),console.log("Valid highlights after filtering:",n),L){const e=Number.parseFloat(L);console.log("Applying confidence filter:",e),n=n.filter(t=>{const n=t.confidence>=e;return!n&&y&&console.log("Highlight filtered out by confidence:",t),n})}const r=n.map(e=>({text:e.text.trim(),confidence:e.confidence,id:e.id}));return console.log("Final processed highlights:",r),r}catch(e){return console.error("Error processing text highlights:",e),$(e,"Error parsing textHighlightJSON:"),[]}},[p,L,y]),V=(0,r.useMemo)(()=>{if(!T)return null;try{if(T.startsWith("blob:"))return T;if(T.startsWith("http://")||T.startsWith("https://"))return y&&console.log("PDFViewerAdvanced: Processing external URL:",T),T;if("undefined"==typeof Blob||"undefined"==typeof URL||"function"!=typeof URL.createObjectURL)throw new TypeError("Required browser APIs for Blob handling are unavailable");const e=T.trim();if(!e)return null;const t=(e.startsWith("data:")?e.slice(e.indexOf(",")+1):e).replaceAll(/\s+/g,""),n="undefined"==typeof globalThis?void 0:globalThis,r=n?.atob,o=n?.Buffer,i=(e=>{if("function"==typeof r)return r(e);if(o&&"function"==typeof o.from)return o.from(e,"base64").toString("binary");throw new Error("No base64 decoder available")})(t),a=i.length,c=new Uint8Array(a);for(let e=0;e<a;e+=1)c[e]=255&(i.codePointAt(e)??0);const s=new Blob([c],{type:"application/pdf"}),l=URL.createObjectURL(s);return y&&console.log("PDFViewerAdvanced: Created blob URL:",`${l.substring(0,50)}...`),l}catch(e){return $(e,"PDFViewerAdvanced: Error processing PDF source:"),y&&console.error("PDFViewerAdvanced: PDF processing error:",e),null}},[T,y]),[N,B]=(0,r.useState)([]),[_,q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!V||0===O.length||!_)return void B([]);B([]),y&&console.log("Starting text search for terms:",O);const e=setTimeout(async()=>{try{const e=await(async(e,t=30,n=200)=>{const r=[];let o=0,i=null;for(;o<t;){if(i=document.querySelectorAll(".rpv-core__text-layer"),i&&i.length>0&&i[0].querySelectorAll("span").length>0){console.log(`Found ${i.length} text layers with content after ${o+1} attempts`);break}await new Promise(e=>setTimeout(e,n)),o+=1}if(!i||0===i.length)return console.warn("No text layers found in the DOM"),r;for(const[t,n]of Array.from(i).entries()){const o=n.closest(".rpv-core__page-layer");if(!o){console.warn(`Page ${t}: No page container found`);continue}const i=o.querySelector("canvas");if(!i){console.warn(`Page ${t}: No canvas found`);continue}const a=i.getBoundingClientRect();if(0!==a.width&&0!==a.height){console.log(`Page ${t} canvas dimensions:`,{width:a.width,height:a.height,left:a.left,top:a.top});for(const o of e){const e=n.querySelectorAll("span"),i=o.text.toLowerCase();for(const n of Array.from(e)){const e=(n.textContent||"").toLowerCase();if(e.includes(i)){const i=n.getBoundingClientRect(),c=(i.left-a.left)/a.width,s=(i.top-a.top)/a.height,l=(i.right-a.left)/a.width,d=(i.bottom-a.top)/a.height;console.log(`Found "${o.text}" on page ${t}:`,{spanText:e,spanRect:{left:i.left,top:i.top,right:i.right,bottom:i.bottom,width:i.width,height:i.height},canvasRect:{left:a.left,top:a.top,width:a.width,height:a.height},relative:{left:c,top:s,right:l,bottom:d}}),r.push({id:`${o.id}_page${t}_${r.length}`,confidence:o.confidence,pageIndex:t,boundingBox:{left:c,top:s,right:l,bottom:d}})}}}}else console.warn(`Page ${t}: Canvas has zero dimensions`)}return console.log(`Text search complete. Found ${r.length} matches for ${e.length} terms`),r})(O);y&&console.log("Text search complete. Found highlights:",e),B(e)}catch(e){console.error("Error performing text search:",e),$(e,"Error performing text search:"),B([])}},1500);return()=>clearTimeout(e)},[V,O,y,_]);const U=(0,a.highlightPlugin)({renderHighlights:e=>(0,l.jsxs)("div",{children:[H.map(t=>{const{pageIndex:n,boundingBox:r}=t;return n!==e.pageIndex?null:(0,l.jsx)("button",{type:"button",onClick:()=>j(t.id),disabled:!I,style:{position:"absolute",left:100*r.left+"%",top:100*r.top+"%",width:100*(r.right-r.left)+"%",height:100*(r.bottom-r.top)+"%",backgroundColor:"rgba(255, 255, 0, 0.3)",border:"1px solid #ff0",pointerEvents:I?"auto":"none",cursor:I?"pointer":"default",opacity:I?1:.7,zIndex:1},"aria-label":`Select highlight ${t.id}`},t.id)}),N.map(t=>{const{pageIndex:n,boundingBox:r}=t;return n!==e.pageIndex?null:(0,l.jsx)("button",{type:"button",onClick:()=>j(t.id),disabled:!I,style:{position:"absolute",left:100*r.left+"%",top:100*r.top+"%",width:100*(r.right-r.left)+"%",height:100*(r.bottom-r.top)+"%",backgroundColor:"rgba(0, 255, 0, 0.3)",border:"1px solid #0f0",pointerEvents:I?"auto":"none",cursor:I?"pointer":"default",opacity:I?1:.7,zIndex:3},"aria-label":`Select highlight ${t.id}`},t.id)})]})}),W=(0,c.searchPlugin)(),M=(0,r.useMemo)(()=>{const e=[U];return m&&e.push(W),e},[U,W,m]);if((0,r.useEffect)(()=>()=>{V&&URL.revokeObjectURL(V)},[V]),console.log("PDFViewerAdvanced render decision:",{hasPdfUrl:!!V,pdfUrl:V?`${V.substring(0,50)}...`:"null",willShowNoPdfMessage:!V}),!V||!o){let e="";return null===V?e="No PDF to display.":null===o&&(e="PDF Worker not found."),(0,l.jsx)(s.A,{container:{direction:"column",alignItems:"center",justify:"center"},style:{height:f},children:(0,l.jsx)(b,{variant:"info",children:e})})}return(0,l.jsxs)("div",{style:{height:f,border:"1px solid #ccc"},children:[(0,l.jsx)(i.Worker,{workerUrl:o,children:(0,l.jsx)(i.Viewer,{fileUrl:V,plugins:M,defaultScale:i.SpecialZoomLevel.PageWidth,onDocumentLoad:e=>{q(!0),y&&(console.log("PDF document loaded successfully:",{numPages:e.doc?.numPages}),console.log("Text search terms to highlight:",O))},renderTextLayer:C})}),y&&(0,l.jsxs)("div",{style:{padding:"10px",backgroundColor:"#f5f5ff",borderTop:"1px solid #ccc"},children:[(0,l.jsx)(w.A,{variant:"h6",children:"Debug Information"}),(0,l.jsxs)(w.A,{children:["Coordinate Highlights: ",H.length]}),(0,l.jsxs)(w.A,{children:["Text Highlights Found: ",N.length]}),(0,l.jsxs)(w.A,{children:["Search Terms: ",O.length]}),O.length>0&&(0,l.jsxs)("div",{style:{fontSize:11,marginTop:4},children:["Terms: ",O.map(e=>`"${e.text}"`).join(", ")]}),N.length>0&&(0,l.jsxs)("div",{style:{marginTop:8},children:[(0,l.jsx)(w.A,{variant:"h6",style:{fontSize:12},children:"Found Highlights:"}),(0,l.jsx)("div",{style:{fontSize:11,fontFamily:"monospace",maxHeight:"200px",overflow:"auto"},children:N.map((e,t)=>(0,l.jsxs)("div",{style:{marginBottom:4,borderBottom:"1px solid #ddd",paddingBottom:2},children:[(0,l.jsxs)("div",{children:["#",t+1,": ",e.id," (confidence: ",e.confidence,")"]}),(0,l.jsxs)("div",{children:["Page: ",e.pageIndex,", Box: L",e.boundingBox.left.toFixed(3)," T",e.boundingBox.top.toFixed(3)," R",e.boundingBox.right.toFixed(3)," B",e.boundingBox.bottom.toFixed(3)]})]},e.id))})]}),(0,l.jsxs)(w.A,{children:["Confidence Filter: ",null!=L?String(L):"None"]})]})]})})},4869:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(e,t)=>(e.getTestIds=t,e)},5556:(e,t,n)=>{e.exports=n(2694)()},6671:()=>{},6925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7491:(e,t,n)=>{"use strict";n.d(t,{A:()=>s,U:()=>c});var r=n(4848),o=n(1594),i=n(8267),a=n(1357);const c=i.Ay.span`
  ${a.Ic}
  -webkit-user-select: none;
  user-select: none;
`,s=(0,o.forwardRef)(function(e,t){return(0,r.jsx)(c,{...e,ref:t})})},7492:()=>{},7501:(e,t,n)=>{"use strict";n.d(t,{A:()=>u,D:()=>g});var r=n(4848),o=n(1594),i=n(8267),a=n(9549);const c=e=>["between","around","evenly"].includes(e)?`space-${e}`:["start","end"].includes(e)?`flex-${e}`:e,s=(e,t)=>{if(!e)return"";if(!0===e)return i.AH`
      display: flex;
    `;const n=(e=>{if(!Array.isArray(e))return[e,e,e,e];switch(e.length){case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return e;default:return[void 0,void 0,void 0,void 0]}})(e.pad);if(e&&"object"==typeof e){const r=!e.direction||e.direction.includes("row"),o=e.direction&&e.direction.includes("reverse");return i.AH`
      display: ${e.inline?"inline-flex":"flex"};

      ${void 0!==n[0]&&i.AH`
        padding-block-start: calc(${n[0]} * ${t});
      `}
      ${void 0!==n[1]&&i.AH`
        padding-inline-end: calc(${n[1]} * ${t});
      `}

        ${void 0!==n[2]&&i.AH`
        padding-block-end: calc(${n[2]} * ${t});
      `}

        ${void 0!==n[3]&&i.AH`
        padding-inline-start: calc(${n[3]} * ${t});
      `}

      ${e.direction&&i.AH`
        flex-direction: ${e.direction};
      `}

      ${e.justify&&i.AH`
        justify-content: ${c(e.justify)};
      `}

      ${e.wrap&&i.AH`
        flex-wrap: ${e.wrap};
      `}

      ${e.alignItems&&i.AH`
        align-items: ${c(e.alignItems)};
      `}

      ${e.alignContent&&i.AH`
        align-content: ${c(e.alignContent)};
      `}

      ${e.itemGap&&i.AH`
          > * {
            margin-${r?"inline-start":"block-start"}: calc(${e.itemGap} * ${e=>e.theme.base.spacing});
            ${o?":last-child":":first-child"} {
              margin-${r?"inline-start":"block-start"}: 0;
            }
          }
        `}

      ${void 0!==e.gap&&i.AH`
        gap: calc(${e.gap} * ${e=>e.theme.base.spacing});
      `}

      ${void 0!==e.colGap&&i.AH`
        column-gap: calc(${e.colGap} * ${e=>e.theme.base.spacing});
      `}

      ${void 0!==e.rowGap&&i.AH`
        row-gap: calc(${e.rowGap} * ${e=>e.theme.base.spacing});
      `}
    `}},l=e=>i.AH`
    ${e&&i.AH`
      max-width: 100%;
      min-width: 0;

      ${void 0!==e.grow&&i.AH`
        flex-grow: ${e.grow};
      `}

      ${void 0!==e.shrink&&i.AH`
        flex-shrink: ${e.shrink};
      `}

      ${e.alignSelf&&i.AH`
        align-self: ${c(e.alignSelf)};
      `}

      ${e.basis&&i.AH`
        flex-basis: ${e.basis};
      `}
    `}
  `,d=["xs","sm","md","lg","xl"],g=i.Ay.div(({container:e,item:t,theme:{base:{breakpoints:n,spacing:r}},xs:o,sm:a,md:c,lg:g,xl:u})=>{const h={xs:o,sm:a,md:c,lg:g,xl:u};return i.AH`
      ${s(e,r)}
      ${l(t)}

    ${d.map(e=>h[e]&&i.AH`
            @media screen and (min-width: ${n[e]}) {
              ${s(h[e]?.container,r)}
              ${l(h[e]?.item)}
            }
          `)}
    `});g.defaultProps=a.qn;const u=(0,o.forwardRef)(function(e,t){return(0,r.jsx)(g,{...e,ref:t})})},7521:(e,t,n)=>{"use strict";n.d(t,{A:()=>g,D:()=>d});var r=n(4848),o=n(1594),i=n(8267),a=n(1357),c=n(9549),s=n(9187),l=n(7321);const d=i.Ay.span(e=>{const{variant:t,status:n,theme:{base:{"font-size":r,"font-scale":o,"font-family":c,palette:{"foreground-color":d,urgent:g,warn:u,success:h},transparency:{"transparent-2":f}},components:{text:p}}}=e;let v;n&&(v={error:g,warning:u,success:h}[n]),"secondary"===t&&(v=(0,s.A)(()=>(0,a.B3)(v??d,f)));const m=(0,l.Vr)(r,o);return i.AH`
    font-size: ${m[p[t]["font-size"]]};
    font-weight: ${p[t]["font-weight"]};
    font-family: ${p[t]["font-family"]||c};
    color: ${v};
  `});d.defaultProps=c.qn;const g=(0,o.forwardRef)(function({variant:e="primary",as:t,...n},o){return!t&&/h\d/i.test(e)&&(t=e),(0,r.jsx)(d,{ref:o,variant:e,as:t,...n})})},7640:()=>{},8044:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(e,t)=>n=>{const r=`${n??""}:${e}:`,o=Object.fromEntries(t.map(e=>{return[(t=e,t.replace(/^-+/g,"").replace(/-+(.)?/g,(e,t)=>t.toUpperCase())),`${r}${e}`];var t}));return o.root=r,o}},8579:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(1594),o=n(9463);const i=(e,t)=>{const{testIds:n}=(0,o.A)();return(0,r.useMemo)(()=>n?"object"==typeof e&&e?e:t(e):{},[n,e,t])}},8866:(e,t,n)=>{"use strict";n.d(t,{EF:()=>o,XP:()=>a,gF:()=>i});var r=n(8044);(0,r.A)("alert",[]);const o=(0,r.A)("count",[]),i=(0,r.A)("keyboard",[]),a=((0,r.A)("selectable",["remove"]),(0,r.A)("status",[]));(0,r.A)("tag",[])},9463:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(1594),o=(n(8347),n(4680)),i=n(1649);const a=()=>{const e=o.A?window.cosmos.configurationContext??i.Q:i.Q;return(0,r.useContext)(e)}}}]);
//# sourceMappingURL=Aja100_Any_jaygasi_PDFViewerAdvanced.a07b50f3.js.map